var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(t,e){t.appendChild(e)}function c(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode&&t.parentNode.removeChild(t)}function l(t){return document.createElement(t)}function a(t){return document.createTextNode(t)}function d(){return a(" ")}function f(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function h(t){return""===t?null:+t}function $(t,e){e=""+e,t.data!==e&&(t.data=e)}function m(t,e){t.value=null==e?"":e}function _(t,e,n){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}n&&void 0===e||(t.selectedIndex=-1)}let g;function v(t){g=t}const y=[],b=[];let x=[];const w=[],C=Promise.resolve();let k=!1;function U(t){x.push(t)}function G(t){w.push(t)}const I=new Set;let L=0;function S(){if(0!==L)return;const t=g;do{try{for(;L<y.length;){const t=y[L];L++,v(t),E(t.$$)}}catch(t){throw y.length=0,L=0,t}for(v(null),y.length=0,L=0;b.length;)b.pop()();for(let t=0;t<x.length;t+=1){const e=x[t];I.has(e)||(I.add(e),e())}x.length=0}while(y.length);for(;w.length;)w.pop()();k=!1,I.clear(),v(t)}function E(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(U)}}const D=new Set;let M;function T(t,e){t&&t.i&&(D.delete(t),t.i(e))}function q(t,e,n,o){if(t&&t.o){if(D.has(t))return;D.add(t),M.c.push((()=>{D.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function P(t,e){t.d(1),e.delete(t.key)}function H(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function N(t){t&&t.c()}function W(t,n,s,i){const{fragment:c,after_update:u}=t.$$;c&&c.m(n,s),i||U((()=>{const n=t.$$.on_mount.map(e).filter(r);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(U)}function j(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];x.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),x=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function A(t,e){-1===t.$$.dirty[0]&&(y.push(t),k||(k=!0,C.then(S)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function O(e,r,s,i,c,l,a,d=[-1]){const f=g;v(e);const p=e.$$={fragment:null,ctx:[],props:l,update:t,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(f?f.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:r.target||f.$$.root};a&&a(p.root);let h=!1;if(p.ctx=s?s(e,r.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&c(p.ctx[t],p.ctx[t]=r)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](r),h&&A(e,t)),n})):[],p.update(),h=!0,o(p.before_update),p.fragment=!!i&&i(p.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);p.fragment&&p.fragment.l(t),t.forEach(u)}else p.fragment&&p.fragment.c();r.intro&&T(e.$$.fragment),W(e,r.target,r.anchor,r.customElement),S()}v(f)}class X{$destroy(){j(this,1),this.$destroy=t}$on(e,n){if(!r(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function B(e){let n;return{c(){n=l("footer"),n.innerHTML='<div class="content has-text-centered"><p><strong>Proxmox LXC idmap helper</strong> by\n            <a href="https://nieradko.com">Stanisław Nieradko</a>.\n            <a href="https://github.com/KanarekLife/proxmox-idmap-helper">The source code</a>\n            is released under\n            <a href="http://opensource.org/licenses/mit-license.php">MIT License</a>.</p> \n        <p>Created with ❤️ @ 2021</p></div>',p(n,"class","footer")},m(t,e){c(t,n,e)},p:t,i:t,o:t,d(t){t&&u(n)}}}class K extends X{constructor(t){super(),O(this,t,null,B,s,{})}}function R(t,e,n){const o=t.slice();return o[13]=e[n],o[14]=e,o[15]=n,o}function z(t,e){let n,r,s,a,$,g,v,y,b,x,w,C,k,U,G,I,L,S,E;function D(...t){return e[6](e[13],e[14],e[15],...t)}function M(){e[7].call(w,e[14],e[15])}function T(){e[8].call(U,e[14],e[15])}function q(...t){return e[9](e[13],...t)}return{key:t,first:null,c(){n=l("tr"),r=l("td"),s=l("div"),a=l("select"),$=l("option"),$.textContent="User",g=l("option"),g.textContent="User Without User Group",v=l("option"),v.textContent="Group",b=d(),x=l("td"),w=l("input"),C=d(),k=l("td"),U=l("input"),G=d(),I=l("td"),L=l("button"),L.textContent="Remove",$.__value="0",$.value=$.__value,g.__value="1",g.value=g.__value,v.__value="2",v.value=v.__value,p(s,"class","select"),p(w,"class","input svelte-1dn006t"),p(w,"type","number"),p(w,"min","0"),p(w,"max","65534"),p(U,"class","input svelte-1dn006t"),p(U,"type","number"),p(U,"min","0"),p(U,"max","65534"),p(L,"class","button is-danger"),this.first=n},m(t,o){c(t,n,o),i(n,r),i(r,s),i(s,a),i(a,$),i(a,g),i(a,v),_(a,e[13].type.toString()),i(n,b),i(n,x),i(x,w),m(w,e[13].id_in_host),i(n,C),i(n,k),i(k,U),m(U,e[13].id_in_container),i(n,G),i(n,I),i(I,L),S||(E=[f(a,"blur",D),f(w,"input",M),f(U,"input",T),f(L,"click",q)],S=!0)},p(t,n){e=t,1&n&&y!==(y=e[13].type.toString())&&_(a,e[13].type.toString()),1&n&&h(w.value)!==e[13].id_in_host&&m(w,e[13].id_in_host),1&n&&h(U.value)!==e[13].id_in_container&&m(U,e[13].id_in_container)},d(t){t&&u(n),S=!1,o(E)}}}function F(e){let n,r,s,a,$,g,v,y,b,x,w,C,k,G,I,L,S,E,D,M,q,H,N,W,j,A,O,X,B,K,F,J,Q=[],V=new Map,Y=e[0];const Z=t=>t[13];for(let t=0;t<Y.length;t+=1){let n=R(e,Y,t),o=Z(n);V.set(o,Q[t]=z(o,n))}return{c(){n=l("section"),r=l("h1"),r.textContent="Input",s=d(),a=l("h2"),a.textContent="Enter which uids or gids you want to pass:",$=d(),g=l("div"),v=d(),y=l("div"),b=l("table"),x=l("thead"),x.innerHTML='<th>Type</th> \n                <th><abbr title="UID or GID in your proxmox host">H_ID</abbr></th> \n                <th><abbr title="Desired UID or GID in your container">C_ID</abbr></th> \n                <th></th>',w=d(),C=l("tbody");for(let t=0;t<Q.length;t+=1)Q[t].c();var t,o,i,c;k=d(),G=l("tr"),I=l("td"),L=l("div"),S=l("select"),E=l("option"),E.textContent="Choose type of new rule",D=l("option"),D.textContent="User",M=l("option"),M.textContent="User Without User Group",q=l("option"),q.textContent="Group",H=d(),N=l("td"),W=l("input"),j=d(),A=l("td"),O=l("input"),X=d(),B=l("td"),K=l("button"),K.textContent="Add",p(r,"class","title"),p(a,"class","subtitle"),p(g,"class","notifications block"),E.__value="-1",E.value=E.__value,D.__value="0",D.value=D.__value,M.__value="1",M.value=M.__value,q.__value="2",q.value=q.__value,void 0===e[1]&&U((()=>e[10].call(S))),p(L,"class","select"),p(W,"class","input svelte-1dn006t"),p(W,"type","number"),p(W,"placeholder","GID / UID in host for new rule"),p(W,"min","0"),p(W,"max","65534"),p(O,"class","input svelte-1dn006t"),p(O,"type","number"),p(O,"min","0"),p(O,"max","65534"),p(O,"placeholder","GID / UID in container for new rule"),p(K,"class","button is-success"),p(b,"class","table is-bordered is-striped is-fullwidth"),p(y,"class","table-container"),t=y,o="overflow-x",null==(i="auto")?t.style.removeProperty(o):t.style.setProperty(o,i,c?"important":""),p(n,"class","section")},m(t,o){c(t,n,o),i(n,r),i(n,s),i(n,a),i(n,$),i(n,g),i(n,v),i(n,y),i(y,b),i(b,x),i(b,w),i(b,C);for(let t=0;t<Q.length;t+=1)Q[t]&&Q[t].m(C,null);i(C,k),i(C,G),i(G,I),i(I,L),i(L,S),i(S,E),i(S,D),i(S,M),i(S,q),_(S,e[1],!0),i(G,H),i(G,N),i(N,W),m(W,e[2]),i(G,j),i(G,A),i(A,O),m(O,e[3]),i(G,X),i(G,B),i(B,K),F||(J=[f(S,"change",e[10]),f(W,"input",e[11]),f(O,"input",e[12]),f(K,"click",e[4])],F=!0)},p(t,[e]){33&e&&(Y=t[0],Q=function(t,e,n,r,s,i,c,u,l,a,d,f){let p=t.length,h=i.length,$=p;const m={};for(;$--;)m[t[$].key]=$;const _=[],g=new Map,v=new Map,y=[];for($=h;$--;){const t=f(s,i,$),o=n(t);let u=c.get(o);u?r&&y.push((()=>u.p(t,e))):(u=a(o,t),u.c()),g.set(o,_[$]=u),o in m&&v.set(o,Math.abs($-m[o]))}const b=new Set,x=new Set;function w(t){T(t,1),t.m(u,d),c.set(t.key,t),d=t.first,h--}for(;p&&h;){const e=_[h-1],n=t[p-1],o=e.key,r=n.key;e===n?(d=e.first,p--,h--):g.has(r)?!c.has(o)||b.has(o)?w(e):x.has(r)?p--:v.get(o)>v.get(r)?(x.add(o),w(e)):(b.add(r),p--):(l(n,c),p--)}for(;p--;){const e=t[p];g.has(e.key)||l(e,c)}for(;h;)w(_[h-1]);return o(y),_}(Q,e,Z,1,t,Y,V,C,P,z,k,R)),2&e&&_(S,t[1]),4&e&&h(W.value)!==t[2]&&m(W,t[2]),8&e&&h(O.value)!==t[3]&&m(O,t[3])},i:t,o:t,d(t){t&&u(n);for(let t=0;t<Q.length;t+=1)Q[t].d();F=!1,o(J)}}}function J(t){const e=document.createElement("div");e.classList.add("notification","is-danger"),document.querySelector(".notifications").appendChild(e);const n=document.createElement("button");n.classList.add("delete"),n.addEventListener("click",(()=>{e.remove()})),e.innerText=t,e.appendChild(n)}function Q(t,e,n){let o,r,s,{rules:i}=e;function c(t){n(0,i=i.filter((e=>e!==t)))}return t.$$set=t=>{"rules"in t&&n(0,i=t.rules)},[i,o,r,s,function(){let t=!0;-1==o&&(J("Type of rule wasn't specified."),t=!1),(!r||"number"!=typeof r||r<0||r>65534)&&(J("H_ID must be a numeric value between 0 and 65534 (inclusive)."),t=!1),(!s||"number"!=typeof s||s<0||s>65534)&&(J("C_ID must be a numeric value between 0 and 65534 (inclusive)."),t=!1),t&&(n(0,i=[...i,{type:o,id_in_host:r,id_in_container:s}]),n(1,o=-1),n(2,r=void 0),n(3,s=void 0))},c,(t,e,o,r)=>n(0,e[o].type=parseInt(r.target.value),i),function(t,e){t[e].id_in_host=h(this.value),n(0,i)},function(t,e){t[e].id_in_container=h(this.value),n(0,i)},(t,e)=>c(t),function(){o=function(t){const e=t.querySelector(":checked");return e&&e.__value}(this),n(1,o)},function(){r=h(this.value),n(2,r)},function(){s=h(this.value),n(3,s)}]}class V extends X{constructor(t){super(),O(this,t,Q,F,s,{rules:0})}}var Y;!function(t){t[t.UserWithGroup=0]="UserWithGroup",t[t.User=1]="User",t[t.Group=2]="Group"}(Y||(Y={}));const Z=["# Generated with Proxmox LXC idmap helper created by Stanisław Nieradko"];function tt(t,e=1e5){const n=function(t){const e=new Map;for(const n of t)e.set(n.id_in_host,n);return e}(t);let o=[],r=[],s=[];for(let t=0;t<65536;t++){const e=n.get(t);e?(e.type==Y.Group&&(s=s.filter((t=>t!==e.id_in_host)),r.push(t)),e.type==Y.User&&(r=r.filter((t=>t!==e.id_in_host)),s.push(t)),o=o.concat(st(e))):(r.push(t),s.push(t))}return o=o.concat(rt(r).map((t=>ot("u",e,t)))).concat(rt(s).map((t=>ot("g",e,t)))),Z.concat(o.sort(et).map(nt)).join("\n")}function et(t,e){return t.start_host-e.start_host}function nt(t){return`lxc.idmap: ${t.type} ${t.start_container} ${t.start_host} ${t.count}`}function ot(t,e,n){return{type:t,start_host:n.start,start_container:n.start+e,count:n.count}}function rt(t){const e=[];let n=[];for(const o of t)null!=n.slice(-1)[0]&&n.slice(-1)[0]+1==o||(n.length>0&&e.push({start:n[0],count:n.length}),n=[]),n.push(o);return n.length>0&&e.push({start:n[0],count:n.length}),e}function st(t){return t.type==Y.UserWithGroup?[{type:"u",start_host:t.id_in_host,start_container:t.id_in_container,count:1},{type:"g",start_host:t.id_in_host,start_container:t.id_in_container,count:1}]:t.type==Y.User?[{type:"u",start_host:t.id_in_host,start_container:t.id_in_container,count:1}]:t.type==Y.Group?[{type:"g",start_host:t.id_in_host,start_container:t.id_in_container,count:1}]:(console.error("Invalid rule type found!",t),void alert("Invalid rule type found! Check console to find out what happened!"))}function it(e){let n,o,r,s,f,h,m;return{c(){n=l("section"),o=l("h1"),o.textContent="LXC Configuration",r=d(),s=l("h2"),s.innerHTML='Paste this code into <code class="svelte-18f7qc9">/etc/pve/lxc/{container_id}.conf</code>',f=d(),h=l("code"),m=a(e[0]),p(o,"class","title"),p(s,"class","subtitle"),p(h,"class","svelte-18f7qc9"),p(n,"class","section")},m(t,e){c(t,n,e),i(n,o),i(n,r),i(n,s),i(n,f),i(n,h),i(h,m)},p(t,[e]){1&e&&$(m,t[0])},i:t,o:t,d(t){t&&u(n)}}}function ct(t,e,n){let o,{rules:r}=e;return t.$$set=t=>{"rules"in t&&n(1,r=t.rules)},t.$$.update=()=>{2&t.$$.dirty&&n(0,o=tt(r))},[o,r]}class ut extends X{constructor(t){super(),O(this,t,ct,it,s,{rules:1})}}function lt(e){let n,o,r,s,f,h,m;return{c(){n=l("section"),o=l("h1"),o.textContent="SubGid Configuration",r=d(),s=l("h2"),s.innerHTML='Paste this code into <code class="svelte-18f7qc9">/etc/subgid</code>',f=d(),h=l("code"),m=a(e[0]),p(o,"class","title"),p(s,"class","subtitle"),p(h,"class","svelte-18f7qc9"),p(n,"class","section")},m(t,e){c(t,n,e),i(n,o),i(n,r),i(n,s),i(n,f),i(n,h),i(h,m)},p(t,[e]){1&e&&$(m,t[0])},i:t,o:t,d(t){t&&u(n)}}}function at(t,e,n){let o,{rules:r}=e;return t.$$set=t=>{"rules"in t&&n(1,r=t.rules)},t.$$.update=()=>{2&t.$$.dirty&&n(0,o=function(t){const e=t.filter((t=>t.type==Y.Group||t.type==Y.UserWithGroup)),n=[...new Set(e)].map((t=>t.id_in_host)).map((t=>`root:${t}:1`));return Z.concat("root:100000:65536").concat(n).join("\n")}(r))},[o,r]}class dt extends X{constructor(t){super(),O(this,t,at,lt,s,{rules:1})}}function ft(e){let n,o,r,s,f,h,m;return{c(){n=l("section"),o=l("h1"),o.textContent="SubUid Configuration",r=d(),s=l("h2"),s.innerHTML='Paste this code into <code class="svelte-18f7qc9">/etc/subuid</code>',f=d(),h=l("code"),m=a(e[0]),p(o,"class","title"),p(s,"class","subtitle"),p(h,"class","svelte-18f7qc9"),p(n,"class","section")},m(t,e){c(t,n,e),i(n,o),i(n,r),i(n,s),i(n,f),i(n,h),i(h,m)},p(t,[e]){1&e&&$(m,t[0])},i:t,o:t,d(t){t&&u(n)}}}function pt(t,e,n){let o,{rules:r}=e;return t.$$set=t=>{"rules"in t&&n(1,r=t.rules)},t.$$.update=()=>{2&t.$$.dirty&&n(0,o=function(t){const e=t.filter((t=>t.type==Y.User||t.type==Y.UserWithGroup)),n=[...new Set(e)].map((t=>t.id_in_host)).map((t=>`root:${t}:1`));return Z.concat("root:100000:65536").concat(n).join("\n")}(r))},[o,r]}class ht extends X{constructor(t){super(),O(this,t,pt,ft,s,{rules:1})}}function $t(t){let e,n,o,r,s,a,f,h,$;return r=new ut({props:{rules:t[0]}}),a=new ht({props:{rules:t[0]}}),h=new dt({props:{rules:t[0]}}),{c(){e=l("section"),n=l("h1"),n.textContent="Output",o=d(),N(r.$$.fragment),s=d(),N(a.$$.fragment),f=d(),N(h.$$.fragment),p(n,"class","title"),p(e,"class","section")},m(t,u){c(t,e,u),i(e,n),i(e,o),W(r,e,null),i(e,s),W(a,e,null),i(e,f),W(h,e,null),$=!0},p(t,[e]){const n={};1&e&&(n.rules=t[0]),r.$set(n);const o={};1&e&&(o.rules=t[0]),a.$set(o);const s={};1&e&&(s.rules=t[0]),h.$set(s)},i(t){$||(T(r.$$.fragment,t),T(a.$$.fragment,t),T(h.$$.fragment,t),$=!0)},o(t){q(r.$$.fragment,t),q(a.$$.fragment,t),q(h.$$.fragment,t),$=!1},d(t){t&&u(e),j(r),j(a),j(h)}}}function mt(t,e,n){let{rules:o}=e;return t.$$set=t=>{"rules"in t&&n(0,o=t.rules)},[o]}class _t extends X{constructor(t){super(),O(this,t,mt,$t,s,{rules:0})}}function gt(t){let e,n,o,r,s,a,f;function p(e){t[1](e)}let h={};function $(e){t[2](e)}void 0!==t[0]&&(h.rules=t[0]),n=new V({props:h}),b.push((()=>H(n,"rules",p)));let m={};return void 0!==t[0]&&(m.rules=t[0]),s=new _t({props:m}),b.push((()=>H(s,"rules",$))),{c(){e=l("div"),N(n.$$.fragment),r=d(),N(s.$$.fragment)},m(t,o){c(t,e,o),W(n,e,null),i(e,r),W(s,e,null),f=!0},p(t,[e]){const r={};!o&&1&e&&(o=!0,r.rules=t[0],G((()=>o=!1))),n.$set(r);const i={};!a&&1&e&&(a=!0,i.rules=t[0],G((()=>a=!1))),s.$set(i)},i(t){f||(T(n.$$.fragment,t),T(s.$$.fragment,t),f=!0)},o(t){q(n.$$.fragment,t),q(s.$$.fragment,t),f=!1},d(t){t&&u(e),j(n),j(s)}}}function vt(t,e,n){let o=[];return[o,function(t){o=t,n(0,o)},function(t){o=t,n(0,o)}]}class yt extends X{constructor(t){super(),O(this,t,vt,gt,s,{})}}function bt(e){let n;return{c(){n=l("section"),n.innerHTML='<div class="hero-body"><p class="title">Proxmox LXC idmap helper</p> \n        <p class="subtitle">Tool created by <a href="https://nieradko.com">Stanisław Nieradko</a> @ 2021</p></div>',p(n,"class","hero is-small")},m(t,e){c(t,n,e)},p:t,i:t,o:t,d(t){t&&u(n)}}}class xt extends X{constructor(t){super(),O(this,t,null,bt,s,{})}}function wt(e){let n,o,r,s,a,f,p,h;return o=new xt({}),a=new yt({}),p=new K({}),{c(){n=l("main"),N(o.$$.fragment),r=d(),s=l("main"),N(a.$$.fragment),f=d(),N(p.$$.fragment)},m(t,e){c(t,n,e),W(o,n,null),i(n,r),i(n,s),W(a,s,null),i(n,f),W(p,n,null),h=!0},p:t,i(t){h||(T(o.$$.fragment,t),T(a.$$.fragment,t),T(p.$$.fragment,t),h=!0)},o(t){q(o.$$.fragment,t),q(a.$$.fragment,t),q(p.$$.fragment,t),h=!1},d(t){t&&u(n),j(o),j(a),j(p)}}}return new class extends X{constructor(t){super(),O(this,t,null,wt,s,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
